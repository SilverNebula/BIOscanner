import numpy as np
import torch
from torch.nn import functional as F
seq = 'TCTTGCTGCTTTTGAAGGAAGTGATGGTAATAAAGTGAAAACATTTGTGCGAGGGGGTGTTGTTAATGCAGCTAAAGGTAAGTTTATAAAGTATAACTGCTAATAAAGCATAACTGTATTACAGTTTTTGAGCGAGCCCCATCTTGGTTGAATGACTGCAGGTAGATAATTATGAAAGGAAGTTTGGTTGCTTTTGAATTTTACATTTTCTATCAGCACCCTCTAGTGGTTATTATTAATTAGCAAGATAAATGGCCAAGTGTCAATTAATGAGATGCTGAAGACAGATAGCTTTTAAACATATTTAGTTCCTTTCAAGTTTTAAGACAGCAGAGCACTTGTCACAAATTTTAATATGTGTCATAGTTTTGCTATGAAATGATTAAATTAGCATTATTGAGGTGATATTTGAATTTAATTTCATATTTGTTAATAGTGATACATCTTAATACTAAAAGCATTTTACTAATTTTTACTTGTTTTTAAATAAAACAGTAAAGAAAAATATTGCGAAATTAGTTTTGAAACTTAGTATTTTAAATTTCAGAAGAACATGAAACAGATGAAAAAAGAGGTAAAATCTATAAGCCATCTTCAAGATTTGCAGATCAAAAAAATCCTCCAAATCAGTCTTCCAATGAAAGACCACCATCTCTTCTTGTGATAGAAACCAAAAAACCTGTAAGTCATACTTAAGTAATTGACCATTTATGTTCAGAGATGACACTGCCAGTGATACTTCCACTGTAAGCAAGACTTTGGCTTTTTTTCGTTTTTGGTGGGGGCAGGGTGGTAGATGTTAAGTTTTGATGCTTTCTAACCCAGTAATTTACTTAGATGAGAGTTAATGAATTGGGACACGTAGATGATATTCTTTTTATGCTTTTTGAGCAGTGAACATTTGCTATTTATGCTCATAATATATTGCAAGTCAAAAATTGACTATATTGCAAGTCAAAAATTGACTATATTTGACTTGCAATGGGGTTGTCTTTTTAAGCATTTCTGAACTGAGGTATTTAAATTATTAGTATGTGTAGTGTATatttcccagaacatttttggaacattttgggaattactgtcagaattagtgacacttaaaatattctcagtgttagaaaaaatttttttttctttgagggtttagtttttatgggagatggtagacagatgtgggtcatgtcatttggaaccaaatgtggtgaataaATATGATTGCATTGAATAGTAAGCCTGGTTTTTTTTGTGTGGCTTAAAAAATATCTCTAAAAGCAATGAAAAAAAAACCCcagctttattgagatataattcacatacaatacaataaaatttaccttttttttttgagacagtctctctgtcacccaggctagagtgtagtagtgtgattacggctcctgcagcctcaacctcgtaggctcaggtggtcctcccacctcagcctcatgagtagctgggactacaggcaatgtagtcccatgcccagctaattttttggtatttttttgtgaaaatggggttttgccattttgcccaggctggtctcaaactcctggactcaagcgatttgcccacttttgcctcccaaagtgctgggattacagacgcctggctaaaatttatccttttaaagtatacagttgactaggtgcagtggcttatgcctgtaatcctagcactttgggaagctgaggctggaggatggcttgagcccaggagtttgagaccagcctgggcaacatagcaagactccatctttacaaaaagaaaaaaaatttaaataaagtgtacaattgagtggttttaagtatgttgaaaattgtgcaacaatcaccactctaatttcagaatatttttatcaccctaaaaagaaatccctacccattatcagtcactcccattttttttttctattaacttcagtccctgacagcctactaatctactttctgtctcttgatttgtctattctggacattttttatggatggtattatataacgtggtcttttgtatctggcttcattacttagcataatgcttcaaggtgcatctttgttgtggcatgaatcagtacttcattcctttttgtggttgaataatactccattttatggacataccatatattgtttatccatgcattacttagtagatggacatttggattgtttccacttttctgctgttagaaataatgctgctgtaaacattcatgtgtgggctttttttgtgtgaacttatgttttcagttctcttggatacatgtatatacacacaccgagaagtggaattgctgggtcacatggtaactatgtttagccttttgagaaactgccagtttttccaaagtggttgtatcactttacagttccaccagtaatgtatgagggttccagttttctcacgtcgtacactaacactttgagaccagcctgaccaacatggagaaaccccgtctctactaaaaatacaaaattagccgggcatggtggtgcatgcctgtaatcccagctactcgggaggctgaggcaggagaatcgcttgaactcgggaggcagaggttgtggtgagccaagatcacagcattgcactccagcctgggcaacaagagcgaaactccatctcaaaaacaaacaaacaaacaaacaaaactattttgtttgaaaagtttattttagtcattttagtgtgtgtgaagttgtacttcattgtggttttgatttgcatgtacttgattatattgagcatcttttcatgtgtttattgtccatttataagtttcttttggagaaatgtctgttcagatacttggcccactttttaattgggttatttgtatttttgttgttgaatcgtaagagtattttacatcttcttgagtcaaggttcttatcagctatatgatttggaaatgttttctgttctctgggttgtctttgcattttcttgatggaagcatggaggttttaaactttaatggagtccaatttatcagtttttttcttttgtttacgcttttggtgtcatatctaagaaaccatcacctaattcaagattatgaatattcattcctgtggttttctcccaaaagtgttatagttttagctcttacttttatgtccatgaaccattttgagttaatttttgtacatttagtatatggtgtaaagtagaagtccaacttcatttttctgtatgtagatattcagttgtccaagcaccatttgttgaaaagattattcttccctattaaattatgttggcacTTCTAAAAGAAGGATTCCAAAAGTAGATTAAGAAGCAGTTTTAAAAGAGGATTCCAAAGATGTTACTTACTGTTCCAGTAACTCATGTCCTCCAGAGGTGATTTTTGAAGAGTGCGTATTTTTGGCAGTTACTTTCCATGGCAGTTCAGTTACTTCATGTTCATTAATTTCCCTGACTACTGGTTGTCATTTTAATTGTTTAATTGTAGTAATAATTTAATTGTTTGTTATTTTGAAGGAAGGGGAAGGGAGGTTCAATGATAAGAAAAGCATTCTTCCTTTTTAATTTAAATAATTAGAACATACAATTTGTACTGAAATGATGTAAAAAGGCTCTTATTATTGAATCATTGGTTTTGCTTATCCTTTTGTTTGAAGTATAACTTGTCATATCCTTTATAGCCACTTAAAAAAGGAGAGAAAGAAAAGAAAAAAAGCAATTTGGAACTCTTCAAAGAAGAATTAAAGCAGTAAGTTTTATAGTGTGGAGAATAACTATCATAGGTGTATTGAGCTGATACATAAACAGATGCAAGTATAAAGAATATACTGTACCAGTTAGTTATTACTAACCAGTTTGCTATGAGATTGTTTTAGATATTATAATATTTGGTGGGCTATCTTTGAAAATAAATTAGCATTTAGTCCAGCACCTGGGTTGCTTGCATTACGAGGATTCAGTTCAATTGATTTACTTAATGTCCAGAGTCCTGTTTGCAGTGGAAACAGTATACTCACTGGGATGGGAGTGAGGGGCAGTTAGACTTAGCAAGAAACAAATTCAGTGGTTTTAGTGTTTAATTTCCTCCTCACCTTTAAAGTAGGCTTTGTGTTCCATTGGTAGTATGATATATCAGAAATTTGCTCGTGGTTGTATTATAGCTGAGGGACCCTCTAATCTTGGTTATCAGTACCAGTATTTAATTACAGATATTTCTAGTTATTTGATGATAGTAATTTGATAAGCGCTATTCTGAAATGTGAATGAACAAATTTTGGCTCATTATAAGTGATTGTAAATATTTTCAACAGAATTCAAGAGGAACGTGATGAGAGACATAAAACAAAAGGCAGATTAAGTCGATTTGAACCTCCTCAGTCAGATTCTGATGGTCAGCGTCGTTCTAGTAAGTGGCATTTATTTTAATGTGTATGCTTGTGATTAATTAcagtagttcccaccttatccgtggcgggttacattccaaggatcaccagtggatgtctgaaaccatggatatatactatccttttccttacacattcatagctgtggtaaaaattaatttgtaaattaggcacagtaagagattaacaacaataagtaatagaacaattataacaatatactgaaataaaagttatgtgcaatcccaacactttgggaggccgaggcaagtggattacctaaggtcaggagttcgagaccagcctggccaacatgatgaaaccctgtctgtactaaaaatacaaaattagccgggcgtggtggtgcgtgcctgtaatcccagctactcaggaggctgaggcagaaggattgcttgaacctgagaggcagaggttgcagtgagccgagaacgtgccattgcactccagcctgggcgacagagcaagagtctgtctcaaaaaaCAACAACAACAACAACAGAGTTGTGTGAAGTGGTCTCTCTTTTTGTCTCTCAGAAATACCTTACTGTAACAAACTGGGGGAAACAAAGGTGAGGGTAAGGGGGGACTACTGTATTATAAAAACTAATAATTGTCTTCTTTTCTCCCCTTTAAGTGGACGCGCCTTCAAGAAGAAATAGATCATCTGGTGGTAATACAGTTTTTTGCTCTTTTAATCGATAAATTTTCCAAACTTTATGTTTTGCAGGTTATAATTCTTTTTTTCTTTCTGCCCTAGTTCTTGATGATTACGCACCTGGCTCACATGATGTAGGAGATCCAAGCACTACTAATTTATACCTTGGAAACATTAATCCACAGGTAATATTAAGTAAGATGAATGTTGATTGATATGCTTTATGCTTTTGGAAGAAAGCTTTGTTAGTCAAAAAAAATCAAGATTCTGAAGCTGACAAATCTGATGGAATTGGATAGTCTTTAGAGTTGTCTTACTGGTATGGCCCAGGTTGTCTTGCCACATATTCTTGTTTCCTCTTTCAGTAACTAGATTGAACTCTGGATTTGAAATGTTTTACTAGGTGCTGATTTTATTATTAAATCAGGGTGTGACCATTGATGAATAATATTATTTTGAGACTGTCCACTTCTGATGCATACTTGTTTCCTTGTGGAGTCCCTTTTTCTTCTCATAGTAGTAAACTACTCTTTGTGGTTTGTCTTTTATATTTTAATTCTTTTCCTGCATTGGTGCTGTTAATTATGATATGGGGAATGTAGTAACGGTAGTATATAATATGCtattattaaaaattatattttGCATATATACTGTTACCTGTTTTCTCTGCATTTGATTACATGGGTAGTTGATTGTTAGAACAGATGATTAGATACTTTTTTTCTTCATTGTCAATACATATTTCCTCTTTAATTTAAATGTACTAACCATGCCTGCTTGAAAAATGTTACTAAATGCCTAAACAAACCATCACTATAAAACATCTTACTTAGATCCAGGACCTTAAAACAAAGGAAGATAGAGAGTAAAAATGATTTTGATTTCTTCATCCACTGAACTTCCCCACCCTGGCATCTTAAATAAACCAGAATATTTATAGTATGAAATGATTTATGAATGCCCCACGCGGGATTTTACTTGTGTGGCGTTCCTGGTACTTAAATGGAAAATTGAAGCACGTTGCTATGTTGCTTTTTATTTTGTAAAAACTACTTTGTTTTCTGAAAATAATTTTTTCTTTTCCCTTTTTTGCATAATAAAAATCTTTTACCCTTTTTAATAGATGAATGAAGAAATGCTGTGCCAAGAATTTGGAAGATTTGGACCGTTAGCCAGTGTGAAAATCATGTGGCCTAGAACTGATGAAGAAAGAGCCAGAGAGAGAAATTGCGGCTTTGTGGCCTTTATGAATAGAAGAGATGCTGAAAGAGCTTTAAAAAATTTGAATGGTAAGAACATTTTTATTATCCATTTATACAATTCAGATATTTCTTTGGTTTGGAAAAGTATTTATAAAAACTAGGAAGGATTGGACCTGAAATGGAGAGGTTAAAATGAAAATTATTTCAACTCACCAGAAAAATTTTGTTTGGAAACTTTTGAGAGTTAACAAAATGACCTTTCATTTCTTTCTTGTAGGAAAAATGATTATGTCTTTTGAAATGAAGTTAGGTTGGGGTAAAGCTGTACCTATTCCTCCACATCCAATATACATTCCGCCTTCTATGATGGAACATACGCTTCCCCCACCTCCATCCGGACTGCCTTTTAATGCGCAGCCTAGAGAGCGGTTAAAAAACCCTAATGCTCCTATGTTACCGCCACCTAAAAACAAAGAGGATTTTGAGAAGGTAATTTAAAAAATGGACATAAGGCCGCATCTAATTTGTAAATACTAAAGCTGTGGTAGTATTTCTTTTCAACAATTTTATAGAAAATGTGTGTGTAATTCTGTTTGGCAACTTTTAAAGAAATAAGTAGATGTGTTCCCTGCCTTAGCCCATGGAAACCCTATATTTGAAATACTAGGTCATATTTTTATTTGTGGCTACCATTCCTTTTTTGACCACTTGTTAAGTTTTTTTTCCTTTGTCCAGTGTTGTATCCAGATTTGCTTAAGTGTATTAACTAAATTTACTTTGTTCTGAGAAAGTGATACTTTGTATTTGGTTAAGTGACATTTCAATTAGAAAGACCTCCTAAGTAGTTATTGTTTGGATGGCAGCTAGATCTGAGGTATTAGAATATTTGAGAAGATTTATGTGGTTTGTAAAAAATAGTTAATCTAGTAAAAGCAAAGGGTGAGTATTTTCTTTTTAGTAAATAAAACCAACTTAATTTCAAGTTATAAGAATTCGTTGGTTCTATTATGAATTAATTACACTTAAAATGACAGGGCTGGTTTTAAAGGCTTGGGAACAAAGTAGCGAACTGTATGGTCAGAGGCAAACAGTTAATTATTTCACAAATTAAAATCTTTATCTGATAATTCTCAGTGTAGTACCTATTTCAGTGCATTGATGTGCATTCTGGCAGGAATGTTCTGATTCTTTGCATTTGGTGAACGTTTATTGTTCACTGAACACATCCATTTGCATTTATGTAATTGCTTAGTGTATAATGACTTCAAATGCAGTGATTGCCTGCAAAACTTGTGATTAGATATGTAGTATTTTCAATGCATATGTATATTTTTGCTTGTTACTTGTTAACAATACTCACATATTCTATGTTTATTATCTGATGTGACTTCATATACAGACTCTGTCGCAAGCCATAGTCAAAGTGGTTATCCCAACAGAAAGGTACATGTTTTTCTTTATTATTACTGATCTAAATATAGACAATATCCCCTTCTGAATTTAAAAAGAAATGGTGTTGAGGAAAAGGTAGTATCTTGACTGAGCAATGGTTCCTTCCCAGTACTTTTTGCGGGGGGATGTGTGAAATTTAACTAACTTTTGTATACTTTGCAATTTTATGTCAGTATCTTTTTTTGTTTTTATTGTTATCACTGTAGGGAATGTTTATAGTTTGACTAGTTAGAGTGTATTTATTAGCTCTGATTTGGAGTCAGACAATAGACTATTGTCATGGGAAAATAGATGTTTTAAGTGTGTCGTAAATTTCAGATAACGTTACAGTTTGACCCAATCTGTTGTTATTTTTTTCTTGTTTTCTGAATTATCTGCATTTAATATATAACCTTGGTTTGAGTTCTCCTTACTGAAGGCATAGCTTTGTTTTTTGTTTTTTCAATTGATTTTAAGAAGAAATTCCTATTATTGTCATGAACACTGGACATACTAGAAACTTTCTTTTCATGGTAACAAAGGTATTTGGAATTCTTTTATTTTCCTTTCTTCCTTTTTTTCTCTTTCAACACACTATTAAAGCAGAAGAATTCATGCTGTAGGTATGCTCTTGCTCAGTCAAGCTAAGCCTTTTCCCAAACACAGGAACACAACACTGGTTGAATAATAAATGAACACAAAAGAATACCAAATTCTCTTTGACATTGGCCTTGGTGAGCAACACCAGCTGAACTGTCTGCGGCAGCGGGGGACCAGGAAAACATCATGGGATGGATTGGGAAAGTATACAGTTTTTGACCAGACATTGGTACGATCGACTCCAATAAATGTGGTTTTATTATAACTGAGAGACAATtttttgtttttgttttttttttggttattgttGCCCAGAATAAGATAATTACCATTTTAAAATTAAATAATGCACTTTAAATATATCATCTTTTTGTACTACACTGTTTTATTCTAATAGAAAAGTCACCATTTTTAAAATAAACACAATCCTTAAGGAAGAAGAATGTGATTACAGTTCTTTAGTAATCTTGACATCAAGTTAATAACAATTAATTGTCAGATTTTGATTTTAAATAATCATGAAACATTTTAAAAATACTTATAAACTTTTAATTTTCTAAAAATAGATTTATCAGTTACAAGCCTGTTTAAAACTATAGTGGGTTTTTCACCACTGATAAAAGCATTCACAGGATAGTATTTTTGTAGCATTCAAAAAAAGCACATATCTAGTGGTAGCTTTACATGTATGTGGCTCAGCTTATTTCTAAACAAAATTTTGAGTGTGCGTTTTGCCGAAAGTCTTCACTCACCATTAGGATGAATCCTTTGTTTTTAAACTTGCTAAACAATTTTCCTCTATCTTAAATGCTAAAGTCAAGTTGCTTTTGACTTAATTCACACAAGTTTCTGGATGTATAACATTTGTCCACCTAGTAATTAGTCTTATACATAAAATTTCCCTTAGCTTTAATTTGGCTCCTATCAGTGGGGAGTTTTGGAATTGAATCATAACTTTACATTATCGCCCTTCCTTCAAAATAATGTCATTAACCATATGAATGCTGAAGAACTGCATATTTGCAGAGCAATTACTTCTGTGAAAGAGAAATAATTTTTAAATAGAAAATTAAGCAATGTTTTTAGTTTTTTGTTTTGACAATTTGAGGTTGAATTAGTAGTTTTAAATGCATGATTTCCCCTTTGTAAAGATTTAAACTGTGATGCAATTTTTTTTACTTCCTTTAGGCTTAAATTTTTTTCACTATGGAGAGATTTCATTTTAAGTAGGTTTGTTTGAAAGCTATGAGAAAATAATTATAGTCACCTTGAGATAGATTATTTTATTGTTCATGTACTCTGAAATAGGGCATTATAGAGCCACAAAAGTCTGTCTTGTTCTATAACTATATATTTATTTACATTCTAGCAGTTATATGAACGTAATTTGAGCTGGGAATGCTAAAGGTGTAATTTAGTGTGTGCTTTGTACCAAGAGCCAATATCCTTTTGCTTTTCCCAATTGTTATTTGCCAGCTGTGTATGGATGGGGACTGGTGAAATGAGGAATCAAAAGCAGCTTATAAATAACCTGAGTCATTTTTGCCCGACACCATAATCAATGTCCAAAATTGTGTTTGGAGTCTAATAAAATATCACATGATTTTAGGACCCAGCTTCAGATAAAGACTTCCTGTGAGTTCAGTCAATAAAATGACTGTACTAAAAAATTACTCACATATGTTTATTTTTGGTAAAATATTGGAAAATAATTGTTACAGAAAATGGGAAGGGCATCTCACCGTGTACCCCATTTTGCAATATTTTGGAAAGAGTAGTACTCCATTCACTTAAGGCTTTGGCAACATAATTTCT'
# A G C T
# 0 1 2 3
seq_map = {
    'A':0,
    'G':1,
    'C':2,
    'T':3,
}
# Chromosome 3: 142,740,137-142,740,263
# data = np.loadtxt('motif.txt')
data = np.load('dscore.npy')
print(data.shape)
data = data[:,:,5000:5000+127]
# data = F.softmax(torch.tensor(data),dim=1).numpy()
# data = data[:] - data[0]
data = np.abs(data[:] - data[0])
data = np.max(data, axis=(1, 2))
# data = np.sum(np.max(data,axis=1),axis=1)
data = data[1:].reshape(-1, 4)
print(data.shape)
data = data
maxdata = np.argmax(data,axis=1)
score = np.zeros_like(data)
for i in range(data.shape[0]):
    score[i,seq_map[seq[i+5001]]] = data[i,maxdata[i]]

# score[range(0,data.shape[0]),maxdata] = data[range(0,data.shape[0]),maxdata]
# score /= np.linalg.norm(score)
# score = (score * 100).astype('int')
# score = data
# print(score)
np.savetxt('motif2.txt',score.T,fmt='%.2f ')
# print(data)